<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Dashboard Admin</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
body{
  font-family:Poppins,sans-serif;
  background:#020617;
  color:#fff;
}
.page{max-width:1100px;margin:30px auto;padding:20px;}
table{
  width:100%; border-collapse:collapse; margin-top:20px;
}
th,td{
  border:1px solid #374151;
  padding:8px; font-size:13px;
}
th{background:#0f172a;}
a.btn{
  padding:6px 10px;
  border-radius:6px;
  background:#2563eb;
  color:#fff;
  text-decoration:none;
  font-size:12px;
}
</style>
</head>
<body>

<div class="page">
  <h1>ðŸ“‹ Dashboard Admin</h1>
  <small>Preview & cetak biodata teknisi</small>

  <table>
    <thead>
      <tr>
        <th>Username</th>
        <th>Nama Pegawai</th>
        <th>Aksi</th>
      </tr>
    </thead>
    <tbody id="adminTableBody"></tbody>
  </table>
</div>

<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbzfYMYq83BYCNxITAK-CbGQ0uA5diRWuFw1-kyd7zzqmcFR_3hwWnHtNNDLTF4mUHc/exec";
const ADMIN_KEY = "ADMIN_BIODATA_PTTJ";

document.addEventListener("DOMContentLoaded", loadAdmin);

function loadAdmin(){
  fetch(WEB_APP_URL,{
    method:"POST",
    headers:{ "Content-Type":"text/plain;charset=utf-8" },
    body:JSON.stringify({
      mode:"getAllBiodata",
      adminKey:ADMIN_KEY
    })
  })
  .then(r=>r.json())
  .then(res=>{
    if(!res.ok){ alert("Gagal ambil data"); return; }
    const tbody=document.getElementById("adminTableBody");
    tbody.innerHTML="";
    res.data.forEach(d=>{
      const tr=document.createElement("tr");
      tr.innerHTML=`
        <td>${d.username}</td>
        <td>${d.namaPegawai}</td>
        <td>
          <a class="btn" target="_blank"
            href="teknisi.html?admin=1&user=${d.username}">
            Preview / Cetak
          </a>
        </td>`;
      tbody.appendChild(tr);
    });
  })
  .catch(e=>{
    document.body.innerHTML="<h2 style='color:red'>ERROR DASHBOARD</h2>";
    console.error(e);
  });
}
</script>

</body>
</html>
