<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Admin Biodata Teknisi</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  font-family: Arial, sans-serif;
  background:#f3f4f6;
  padding:20px;
}
h1 { font-size:20px; margin-bottom:8px; }
table {
  width:100%;
  border-collapse:collapse;
  margin-top:12px;
}
th, td {
  border:1px solid #ccc;
  padding:6px 8px;
  font-size:13px;
}
th { background:#e5e7eb; }
button {
  padding:4px 8px;
  margin-right:4px;
  cursor:pointer;
}
#adminPanel { display:none; }
.login-box {
  max-width:320px;
  background:#fff;
  padding:16px;
  border-radius:6px;
}
</style>
</head>

<body>

<div class="login-box">
  <h1>ğŸ” Admin Login</h1>
  <input id="adminUser" placeholder="Admin User"><br><br>
  <input id="adminPass" type="password" placeholder="Admin Password"><br><br>
  <button onclick="loginAdmin()">Login</button>
</div>

<div id="adminPanel">
  <h1>ğŸ“‹ Daftar Biodata Teknisi</h1>
  <table>
    <thead>
      <tr>
        <th>Username</th>
        <th>Nama</th>
        <th>Divisi</th>
        <th>Lokasi</th>
        <th>Aksi</th>
      </tr>
    </thead>
    <tbody id="listTeknisi"></tbody>
  </table>
</div>

<script>
/* ====== KONFIG ====== */
const WEB_APP_URL = "PASTE_WEB_APP_URL_KAMU";
const ADMIN_KEY  = "ADMIN_BIODATA_PTTJ";

/* GANTI USER/PASS ADMIN */
const ADMIN_USER = "admin";
const ADMIN_PASS = "Putija@2025";

/* ====== LOGIN ADMIN ====== */
function loginAdmin() {
  if (adminUser.value !== ADMIN_USER || adminPass.value !== ADMIN_PASS) {
    alert("Login admin gagal");
    return;
  }
  document.querySelector(".login-box").style.display = "none";
  document.getElementById("adminPanel").style.display = "block";
  loadAll();
}

/* ====== LOAD SEMUA TEKNISI ====== */
function loadAll() {
  fetch(WEB_APP_URL, {
    method:"POST",
    headers:{ "Content-Type":"text/plain;charset=utf-8" },
    body: JSON.stringify({
      mode:"getAllBiodata",
      adminKey: ADMIN_KEY
    })
  })
  .then(r=>r.json())
  .then(res=>{
    if (!res.ok) return alert("Gagal load data");
    const tb = document.getElementById("listTeknisi");
    tb.innerHTML = "";

    res.data.forEach(d=>{
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${d.username}</td>
        <td>${d.nama}</td>
        <td>${d.divisi}</td>
        <td>${d.lokasi}</td>
        <td>
          <button onclick="preview('${d.username}')">ğŸ‘€ Preview</button>
          <button onclick="cetak('${d.username}')">ğŸ–¨ Cetak</button>
        </td>
      `;
      tb.appendChild(tr);
    });
  });
}

/* ====== AKSI ====== */
function preview(username) {
  window.open(
    "teknisi.html?admin=1&user=" + encodeURIComponent(username),
    "_blank"
  );
}

function cetak(username) {
  const w = window.open(
    "teknisi.html?admin=1&print=1&user=" + encodeURIComponent(username),
    "_blank"
  );
  w.onload = () => w.print();
}
</script>

</body>
</html>
