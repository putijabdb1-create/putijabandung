<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Login Teknisi ‚Äì PT PUTRA TIMUR JAYA BDB1</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family:Arial,Helvetica,sans-serif;
  background:#020617;
  color:#fff;
  margin:0;
}
.page{max-width:900px;margin:auto;padding:20px}
.card{
  background:#020617;
  border:1px solid #1f2937;
  border-radius:12px;
  padding:16px;
  margin-bottom:16px
}
input,select,textarea{
  width:100%;
  padding:8px;
  margin-bottom:8px;
  background:#020617;
  color:#fff;
  border:1px solid #374151;
  border-radius:8px
}
button{
  padding:8px 14px;
  border-radius:999px;
  border:none;
  cursor:pointer;
  font-weight:bold
}
.btn-primary{background:#2563eb;color:#fff}
.btn-danger{background:#dc2626;color:#fff}
.status{font-size:12px;margin-top:6px}
</style>
</head>

<body>
  <!-- NAVBAR -->
  <header class="navbar">
    <div class="nav-inner">
      <div class="nav-brand">
        <div class="nav-brand-logo">P</div>
        <div class="nav-brand-title">
          <span>PT PUTRA TIMUR JAYA</span>
          <span>BANDUNG BARAT 1</span>
        </div>
      </div>
      <ul class="nav-links">
        <li><a href="index.html">Beranda</a></li>
        <li><a href="program.html">Program</a></li>
        <li><a href="galeri.html">Galeri</a></li>
        <li><a href="teknisi.html" class="active">Login Teknisi</a></li>
        <li><a href="kontak.html">Kontak</a></li>
      </ul>
    </div>
  </header>

  <main class="page">
    <h1 style="font-size:18px;font-weight:600;">Login Teknisi</h1>
    <p style="font-size:12px;color:#9ca3af;margin-top:4px;">
      Halaman khusus untuk teknisi PT PUTRA TIMUR JAYA BDB1. Teknisi harus login terlebih dahulu sebelum mengisi biodata.
    </p>

    <div class="grid-2">
      <!-- LOGIN -->
      <div class="card login-card">
        <h2>Login Teknisi</h2>
        <small>Gunakan user &amp; password yang sama dengan aplikasi absensi teknisi.</small>

        <div style="margin-top:12px;">
          <label for="loginUser">User ID</label>
          <input id="loginUser" placeholder="Contoh: PTJ_Arip007" />

          <label for="loginPass">Password</label>
          <input id="loginPass" type="password" placeholder="Password" />

          <div class="btn-group" style="margin-top:10px;">
            <button class="btn btn-primary" type="button" onclick="loginTeknisi()">üîë Login</button>
            <a class="btn btn-secondary" href="https://putijabdb1-create.github.io/Absen-ptptjbdb1/" target="_blank">üîó Buka Halaman Absensi</a>
          </div>

          <p class="status-text">
            *Data user diambil dari daftar user absensi (USER_LINES) di bawah. Jika ada teknisi baru,
            cukup tambah di daftar user.
          </p>

          <p id="loginStatus" class="status-text"></p>
        </div>
      </div>

      <!-- FORM BIODATA -->
      <div class="card form-card" id="formCard" style="display:none;">
        <h2>Form Biodata Teknisi</h2>
        <small>Data berikut diisi oleh teknisi. Hasilnya akan dikirim ke Google Sheet &amp; bisa dicetak sebagai biodata pegawai.</small>

        <div style="margin-top:12px;">
          <div class="section-title">Data Pribadi</div>

          <label for="namaPegawai">Nama Pegawai</label>
          <input id="namaPegawai" />

          <div class="field-row-2">
            <div>
              <label for="ttl">Tempat / Tanggal Lahir</label>
              <input id="ttl" placeholder="Contoh: Bandung, 12 Juni 1985" />
            </div>
            <div>
              <label for="jenisKelamin">Jenis Kelamin</label>
              <select id="jenisKelamin">
                <option value="">-- Pilih --</option>
                <option value="Laki-laki">Laki-laki</option>
                <option value="Perempuan">Perempuan</option>
              </select>
            </div>
          </div>

          <label for="pendidikanAkhir">Pendidikan Terakhir</label>
          <input id="pendidikanAkhir" placeholder="Contoh: SMA / D3 / S1" />

          <div class="field-row-2">
            <div>
              <label for="pendFormal">Pendidikan Formal (SD - SMP - SMA - PT)</label>
              <textarea id="pendFormal" placeholder="Contoh: SDN..., SMP..., SMA..., Perguruan Tinggi..."></textarea>
            </div>
            <div>
              <label for="pendNonFormal">Pendidikan Non Formal</label>
              <textarea id="pendNonFormal" placeholder="Pelatihan, kursus, sertifikasi, dll."></textarea>
            </div>
          </div>

          <div class="section-title">Data Pekerjaan</div>
          <div class="field-row-2">
            <div>
              <label for="statusPerkawinan">Status Perkawinan</label>
              <select id="statusPerkawinan">
                <option value="">-- Pilih --</option>
                <option value="Belum Menikah">Belum Menikah</option>
                <option value="Menikah">Menikah</option>
                <option value="Cerai">Cerai</option>
              </select>
            </div>
            <div>
              <label for="lokasiKerja">Lokasi Kerja</label>
              <input id="lokasiKerja" placeholder="Contoh: CMI, NJG, CLL, BTJ, GNH, dll." />
            </div>
          </div>

          <div class="field-row-2">
            <div>
              <label for="posisiKerja">Posisi Kerja Sebagai</label>
              <input id="posisiKerja" placeholder="Contoh: BASIC_TEHNIK, ADMIN, dll." />
            </div>
            <div>
              <label for="divisi">Divisi</label>
              <input id="divisi" placeholder="Contoh: IOAN, PSB, PROJEK, PIC" />
            </div>
          </div>

          <div class="section-title">Alamat Tempat Tinggal (Domisili)</div>
          <label for="alamatDomisili">Alamat</label>
          <input id="alamatDomisili" />

          <div class="field-row-2">
            <div>
              <label for="domKel">Kelurahan / Desa</label>
              <input id="domKel" />
            </div>
            <div>
              <label for="domKec">Kecamatan</label>
              <input id="domKec" />
            </div>
          </div>
          <label for="domKota">Kota / Kabupaten</label>
          <input id="domKota" />

          <div class="section-title">Kontak &amp; Rekening</div>
          <div class="field-row-2">
            <div>
              <label for="noHp">Nomor Handphone</label>
              <input id="noHp" />
            </div>
            <div>
              <label for="email">Alamat Email</label>
              <input id="email" type="email" />
            </div>
          </div>

          <div class="field-row-2">
            <div>
              <label for="noKtp">Nomor KTP</label>
              <input id="noKtp" />
            </div>
            <div>
              <label for="noNpwp">Nomor NPWP</label>
              <input id="noNpwp" />
            </div>
          </div>

          <div class="field-row-2">
            <div>
              <label for="namaIbu">Nama Ibu Kandung</label>
              <input id="namaIbu" />
            </div>
            <div>
              <label for="noRekening">Nomor Rekening</label>
              <input id="noRekening" />
            </div>
          </div>
          <label for="namaBank">Nama Bank</label>
          <input id="namaBank" />

          <div class="section-title">Alamat Sesuai KTP</div>
          <label for="ktpAlamat">Alamat</label>
          <input id="ktpAlamat" />
          <div class="field-row-2">
            <div>
              <label for="ktpKel">Kelurahan</label>
              <input id="ktpKel" />
            </div>
            <div>
              <label for="ktpKec">Kecamatan</label>
              <input id="ktpKec" />
            </div>
          </div>
          <label for="ktpKota">Kota</label>
          <input id="ktpKota" />

          <div class="section-title">BPJS &amp; Keluarga</div>
          <div class="field-row-2">
            <div>
              <label for="bpjsKet">BPJS Ketenagakerjaan</label>
              <input id="bpjsKet" />
            </div>
            <div>
              <label for="bpjsKes">BPJS Kesehatan</label>
              <input id="bpjsKes" />
            </div>
          </div>

          <div class="field-row-2">
            <div>
              <label for="namaPasangan">Nama Istri / Suami</label>
              <input id="namaPasangan" />
            </div>
            <div>
              <label for="bpjsPasangan">Nomor BPJS Istri / Suami</label>
              <input id="bpjsPasangan" />
            </div>
          </div>

          <div class="field-row-2">
            <div>
              <label for="telpKerabat">Nomor Telepon Kerabat</label>
              <input id="telpKerabat" />
            </div>
            <div>
              <label for="dataAnak">Data Anak</label>
              <input id="dataAnak" placeholder="Nama anak & tanggal lahir (jika ada)" />
            </div>
          </div>

          <div class="field-row-2">
            <div>
              <label for="namaFaskes">Nama Faskes</label>
              <input id="namaFaskes" />
            </div>
            <div>
              <label for="noKk">Nomor Kartu Keluarga</label>
              <input id="noKk" />
            </div>
          </div>

          <div class="section-title">Foto Teknisi</div>
          <input id="fotoTeknisi" type="file" accept="image/*" />
          <img id="previewFotoForm" class="preview-small" />

          <div class="section-title">Foto Dokumen (opsional)</div>
          <!-- URUTAN: KTP, NPWP, BPJS KET, BPJS KES, KK -->
          <div class="field-row-2">
            <div>
              <label for="fotoKtp">Foto KTP</label>
              <input id="fotoKtp" type="file" accept="image/*" />
              <img id="previewFotoKtp" class="preview-small" />
            </div>
            <div>
              <label for="fotoNpwp">Foto NPWP</label>
              <input id="fotoNpwp" type="file" accept="image/*" />
              <img id="previewFotoNpwp" class="preview-small" />
            </div>
          </div>

          <div class="field-row-2">
            <div>
              <label for="fotoBpjsKet">Foto BPJS Ketenagakerjaan</label>
              <input id="fotoBpjsKet" type="file" accept="image/*" />
              <img id="previewFotoBpjsKet" class="preview-small" />
            </div>
            <div>
              <label for="fotoBpjsKes">Foto BPJS Kesehatan</label>
              <input id="fotoBpjsKes" type="file" accept="image/*" />
              <img id="previewFotoBpjsKes" class="preview-small" />
            </div>
          </div>

          <div>
            <label for="fotoKk">Foto KK</label>
            <input id="fotoKk" type="file" accept="image/*" />
            <img id="previewFotoKk" class="preview-small" />
          </div>

          <div class="btn-group">
            <button class="btn btn-primary" type="button" onclick="saveBiodata()">üíæ Simpan</button>
            <button class="btn btn-secondary" type="button" onclick="showPreviewBiodata()">üëÄ Preview Biodata</button>
            <button class="btn btn-secondary" type="button" onclick="scrollToForm()">‚úè Edit</button>
            <button class="btn btn-danger" type="button" onclick="logoutTeknisi()">üö™ Logout</button>
          </div>

          <p id="formStatus" class="status-text"></p>
        </div>
      </div>
    </div>

<script>
const WEB_APP_URL="https://script.google.com/macros/s/AKfycbzfYMYq83BYCNxITAK-CbGQ0uA5diRWuFw1-kyd7zzqmcFR_3hwWnHtNNDLTF4mUHc/exec";

const USER_LINES=[
"PTJ_Arip007|alvaro007|15889311|ARIP RAHMATULLOH|PIC|CMI"
];

let USERS=USER_LINES.map(l=>{
  const[a,b,c,d,e,f]=l.split("|");
  return{username:a,password:b,nik:c,nama:d,divisi:e,defaultArea:f};
});
let currentUser=null;

function loginTeknisi(){
  const u=loginUser.value.trim();
  const p=loginPass.value.trim();
  const user=USERS.find(x=>x.username===u&&x.password===p);
  if(!user){
    loginStatus.textContent="Login gagal";
    loginStatus.style.color="red";
    return;
  }
  currentUser=user;
  loginStatus.textContent="Login berhasil";
  loginStatus.style.color="lightgreen";
  namaPegawai.value=user.nama;
  divisi.value=user.divisi;
  lokasiKerja.value=user.defaultArea;
  formCard.style.display="block";
}

function logoutTeknisi(){
  currentUser=null;
  formCard.style.display="none";
}

function v(id){return document.getElementById(id).value.trim()}

function collectFormData(){
  return{
    namaPegawai:v("namaPegawai"),
    ttl:v("ttl"),
    jenisKelamin:v("jenisKelamin"),
    pendidikanAkhir:v("pendidikanAkhir"),
    pendFormal:v("pendFormal"),
    pendNonFormal:v("pendNonFormal"),
    statusPerkawinan:v("statusPerkawinan"),
    lokasiKerja:v("lokasiKerja"),
    posisiKerja:v("posisiKerja"),
    divisi:v("divisi"),
    alamatDomisili:v("alamatDomisili"),
    domKel:v("domKel"),
    domKec:v("domKec"),
    domKota:v("domKota"),
    noHp:v("noHp"),
    email:v("email"),
    noKtp:v("noKtp"),
    noNpwp:v("noNpwp"),
    namaIbu:v("namaIbu"),
    noRekening:v("noRekening"),
    namaBank:v("namaBank"),
    ktpAlamat:v("ktpAlamat"),
    ktpKel:v("ktpKel"),
    ktpKec:v("ktpKec"),
    ktpKota:v("ktpKota"),
    bpjsKet:v("bpjsKet"),
    bpjsKes:v("bpjsKes"),
    namaPasangan:v("namaPasangan"),
    bpjsPasangan:v("bpjsPasangan"),
    telpKerabat:v("telpKerabat"),
    dataAnak:v("dataAnak"),
    namaFaskes:v("namaFaskes"),
    noKk:v("noKk")
  }
}

async function saveBiodata(){
  if(!currentUser){alert("Login dulu");return}
  formStatus.textContent="Menyimpan...";
  try{
    const res=await fetch(WEB_APP_URL,{
      method:"POST",
      headers:{"Content-Type":"text/plain;charset=utf-8"},
      body:JSON.stringify({
        mode:"saveBiodata",
        user:currentUser,
        biodata:collectFormData()
      })
    });
    const t=await res.text();
    formStatus.textContent="BERHASIL DISIMPAN";
    formStatus.style.color="lightgreen";
  }catch(e){
    formStatus.textContent="GAGAL: "+e.message;
    formStatus.style.color="red";
  }
}
</script>
</body>
</html>
