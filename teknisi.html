<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Area Teknisi - PT PUTRA TIMUR JAYA BDB1</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet" />
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: "Poppins", sans-serif;
      background: #e5e7eb;
      color: #0f172a;
    }
	.btn-row {
	display: flex;
	flex-wrap: wrap;
	gap: 8px;
	margin-top: 10px;
	}

	.btn-secondary {
	background: #0ea5e9;
	color: #ffffff;
	}

	.btn-outline-red {
	background: #ffffff;
	color: #dc2626;
	border: 1px solid #dc2626;
	}

    a { text-decoration: none; color: inherit; }

    /* NAVBAR */
    .navbar {
      position: sticky;
      top: 0;
      z-index: 50;
      background: #ffffff;
      box-shadow: 0 1px 4px rgba(15, 23, 42, 0.08);
    }
    .nav-inner {
      max-width: 1100px;
      margin: 0 auto;
      padding: 12px 16px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .navbar-logo {
      font-weight: 700;
      font-size: 16px;
      letter-spacing: 0.04em;
    }
    .navbar-nav {
      display: flex;
      gap: 18px;
      list-style: none;
      font-size: 14px;
    }
    .navbar-nav a {
      padding: 6px 10px;
      border-radius: 999px;
      transition: background 0.15s, color 0.15s;
    }
    .navbar-nav a:hover {
      background: #2563eb;
      color: #ffffff;
    }
    .navbar-nav a.active {
      background: #2563eb;
      color: #ffffff;
    }

    /* LAYOUT */
    .wrapper {
      max-width: 1100px;
      margin: 0 auto;
      padding: 24px 16px 40px;
    }
    .page-title {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 6px;
    }
    .page-subtitle {
      font-size: 14px;
      color: #4b5563;
      margin-bottom: 16px;
    }
    .grid-two {
      display: grid;
      grid-template-columns: minmax(0, 1.1fr) minmax(0, 1.3fr);
      gap: 20px;
    }
    @media (max-width: 880px) {
      .grid-two { grid-template-columns: 1fr; }
    }

    .card {
      background: #ffffff;
      border-radius: 18px;
      padding: 18px 18px 20px;
      box-shadow: 0 10px 20px rgba(15, 23, 42, 0.08);
      border: 1px solid #e5e7eb;
    }
    .card h2 {
      font-size: 18px;
      margin-bottom: 4px;
    }
    .card p.small {
      font-size: 12px;
      color: #6b7280;
      margin-bottom: 12px;
    }

    label {
      display: block;
      font-size: 13px;
      margin-bottom: 4px;
    }
    input, select, textarea {
      width: 100%;
      padding: 8px 10px;
      font-size: 13px;
      border-radius: 10px;
      border: 1px solid #d1d5db;
      margin-bottom: 8px;
      outline: none;
      background: #f9fafb;
    }
    input:focus, select:focus, textarea:focus {
      border-color: #2563eb;
      background: #ffffff;
      box-shadow: 0 0 0 1px #2563eb33;
    }
    textarea { resize: vertical; }

    .field-row {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
    }
    @media (max-width: 640px) {
      .field-row { grid-template-columns: 1fr; }
    }

    .section-title {
      font-size: 13px;
      font-weight: 600;
      margin: 10px 0 6px;
      color: #111827;
      border-top: 1px dashed #e5e7eb;
      padding-top: 8px;
    }

    .btn {
      display: inline-block;
      padding: 9px 16px;
      border-radius: 999px;
      border: none;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
    }
    .btn-primary { background: #2563eb; color: #ffffff; }
    .btn-outline {
      background: #ffffff;
      color: #2563eb;
      border: 1px solid #2563eb;
      margin-left: 6px;
    }

    .hidden { display: none; }

    /* PREVIEW BIODATA */
    .preview-wrapper {
      max-width: 1100px;
      margin: 0 auto 40px;
      padding: 0 16px;
    }
    .preview-card {
      margin-top: 24px;
      background: #ffffff;
      border-radius: 16px;
      box-shadow: 0 10px 25px rgba(15, 23, 42, 0.12);
      border: 1px solid #e5e7eb;
      padding: 20px 24px 26px;
    }
    .preview-header {
      text-align: center;
      margin-bottom: 14px;
      font-size: 15px;
    }
    .preview-header .title-main {
      font-weight: 700;
      letter-spacing: 0.08em;
    }
    .preview-header .title-sub {
      font-weight: 600;
      font-size: 13px;
    }
    .preview-grid {
      display: grid;
      grid-template-columns: minmax(0, 2.3fr) 170px;
      gap: 18px;
    }
    @media (max-width: 800px) {
      .preview-grid { grid-template-columns: 1fr; }
    }
    .preview-photo-box {
      border: 1px solid #e5e7eb;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      background: #f9fafb;
      height: 200px;
    }
    .preview-photo-box img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .preview-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 12px;
    }
    .preview-table td {
      padding: 2px 4px;
      vertical-align: top;
    }
    .preview-table td:first-child {
      width: 180px;
      font-weight: 600;
    }
    .preview-subtitle {
      font-size: 12px;
      font-weight: 600;
      margin-top: 8px;
      margin-bottom: 2px;
      text-decoration: underline;
    }
    .note-info {
      font-size: 11px;
      color: #6b7280;
      margin-top: 6px;
    }
  </style>
</head>
<body>
  <!-- NAVBAR -->
  <header class="navbar">
    <div class="nav-inner">
      <div class="navbar-logo">PT PUTRA TIMUR JAYA BDB1</div>
      <ul class="navbar-nav">
        <li><a href="index.html">Beranda</a></li>
        <li><a href="program.html">Program</a></li>
        <li><a href="galeri.html">Galeri</a></li>
        <li><a href="teknisi.html" class="active">Area Teknisi</a></li>
        <li><a href="kontak.html">Kontak</a></li>
      </ul>
    </div>
  </header>

  <main class="wrapper">
    <h1 class="page-title">Area Teknisi</h1>
    <p class="page-subtitle">
      Halaman khusus untuk teknisi PT PUTRA TIMUR JAYA BDB1. Teknisi harus login dulu sebelum mengisi biodata.
    </p>

    <div class="grid-two">
      <!-- LOGIN TEKNISI -->
      <section class="card" id="loginCard">
        <h2>Login Teknisi</h2>
        <p class="small">
          Gunakan user & password yang sama dengan aplikasi absensi teknisi.
          Setelah login berhasil, form biodata akan muncul.
        </p>

        <label for="loginUser">User ID</label>
        <input id="loginUser" placeholder="Contoh: PTJ_Arip007" />

        <label for="loginPass">Password</label>
        <input id="loginPass" type="password" placeholder="Masukkan password" />

        <button class="btn btn-primary" type="button" id="btnLogin">
          üîë Login
        </button>

        <!-- GANTI href DI BAWAH dengan URL absensi teknisi kalau mau -->
        <a class="btn btn-outline" href="https://absen-pttj.netlify.app" target="_blank">
        <a class="btn btn-outline" href="https://putijabdb1-create.github.io/Absen-ptptjbdb1/" target="_blank">
          üîó Buka Halaman Absensi
        </a>

        <p class="note-info">
          *Data user diambil dari daftar user absensi (USER_LINES). Kalau ada teknisi baru, cukup tambah di daftar itu.
        </p>
      </section>

      <!-- FORM BIODATA (disembunyikan sebelum login) -->
      <section class="card hidden" id="bioCard">
        <h2>Form Biodata Teknisi</h2>
        <p class="small">
          Data berikut diisi oleh teknisi setelah login. Hasilnya akan ditampilkan sebagai biodata pegawai
          di bagian bawah halaman.
        </p>

        <form id="bioForm">
          <!-- DATA PRIBADI -->
          <div class="section-title">Data Pribadi</div>
          <label>Nama Pegawai</label>
          <input id="f_nama" required />

          <div class="field-row">
            <div>
              <label>Tempat / Tanggal Lahir</label>
              <input id="f_ttl" placeholder="Contoh: Bandung, 12 Juni 1985" />
            </div>
            <div>
              <label>Jenis Kelamin</label>
              <select id="f_jk">
                <option value="">-- Pilih --</option>
                <option>Laki - Laki</option>
                <option>Perempuan</option>
              </select>
            </div>
          </div>

          <label>Pendidikan Terakhir</label>
          <input id="f_pendidikan" placeholder="Contoh: SMA / D3 / S1" />

          <div class="field-row">
            <div>
              <label>Pendidikan Formal (SD - SMP - SMA - PT)</label>
              <textarea id="f_pendidikan_formal" rows="3"
                placeholder="Nama Sekolah Semua: SDN..., SMP..., SMA..., Perguruan Tinggi..."></textarea>
            </div>
            <div>
              <label>Pendidikan Non Formal</label>
              <textarea id="f_pendidikan_non" rows="3"
                placeholder="Pelatihan, kursus, sertifikasi, dll."></textarea>
            </div>
          </div>

          <div class="field-row">
            <div>
              <label>Status Perkawinan</label>
              <select id="f_status">
                <option value="">-- Pilih --</option>
                <option>Belum Menikah</option>
                <option>Menikah</option>
                <option>Cerai</option>
              </select>
            </div>
            <div>
              <label>Lokasi Kerja</label>
              <input id="f_lokasi_kerja" placeholder="Contoh: Bandung / Cimahi / dll" />
            </div>
          </div>

          <div class="field-row">
            <div>
              <label>Posisi Kerja Sebagai</label>
              <input id="f_posisi" placeholder="Contoh: BASIC_TEHNIK" />
            </div>
            <div>
              <label>Divisi</label>
              <input id="f_divisi" placeholder="Contoh: POJ - IOAN" />
            </div>
          </div>

          <!-- ALAMAT DOMISILI -->
          <div class="section-title">Alamat Tempat Tinggal (Domisili)</div>
          <label>Alamat Lengkap</label>
          <input id="f_alamat_domisili" placeholder="Alamat Sesuai KTP, RT/RW, dll." />
          <div class="field-row">
            <div><label>Kelurahan / Desa</label><input id="f_kel_domisili" /></div>
            <div><label>Kecamatan</label><input id="f_kec_domisili" /></div>
          </div>
          <label>Kota / Kabupaten</label>
          <input id="f_kota_domisili" />

          <!-- KONTAK & REKENING -->
          <div class="section-title">Kontak & Rekening</div>
          <div class="field-row">
            <div><label>Nomor Handphone</label><input id="f_hp" /></div>
            <div><label>Alamat Email</label><input id="f_email" type="email" /></div>
          </div>
          <div class="field-row">
            <div><label>Nomor KTP</label><input id="f_ktp" /></div>
            <div><label>Nomor NPWP</label><input id="f_npwp" /></div>
          </div>
          <div class="field-row">
            <div><label>Nama Ibu Kandung</label><input id="f_ibu" /></div>
            <div><label>Nomor Rekening</label><input id="f_norek" /></div>
          </div>
          <label>Nama Bank</label>
          <input id="f_bank" />

          <!-- ALAMAT KTP -->
          <div class="section-title">Alamat Sesuai KTP</div>
          <label>Alamat KTP</label>
          <input id="f_alamat_ktp" />
          <div class="field-row">
            <div><label>Kelurahan</label><input id="f_kel_ktp" /></div>
            <div><label>Kecamatan</label><input id="f_kec_ktp" /></div>
          </div>
          <label>Kota</label>
          <input id="f_kota_ktp" />

          <!-- BPJS & KELUARGA -->
          <div class="section-title">BPJS & Data Keluarga</div>
          <div class="field-row">
            <div><label>Nomor BPJS Ketenagakerjaan</label><input id="f_bpjs_ket" /></div>
            <div><label>Nomor BPJS Kesehatan</label><input id="f_bpjs_kes" /></div>
          </div>

          <div class="field-row">
            <div><label>Nama Istri / Suami</label><input id="f_pasangan" /></div>
            <div><label>Nomor BPJS Istri / Suami</label><input id="f_bpjs_pasangan" /></div>
          </div>

          <label>Nomor Telepon Kerabat</label>
          <input id="f_telp_kerabat" />

          <label>Data Anak (Nama / Tanggal Lahir / No BPJS)</label>
          <textarea id="f_anak" rows="3"
            placeholder="Isi Semua Anak: 1. Syahril Muhamad Zaelani / Bandung, 10 Februari 2016 / 0002xxx"></textarea>

          <div class="field-row">
            <div><label>Nama Faskes</label><input id="f_faskes" /></div>
            <div><label>Nomor Kartu Keluarga</label><input id="f_kk" /></div>
          </div>

          <!-- FOTO DOKUMEN -->
          <div class="section-title">Upload Foto Dokumen</div>
          <label>Foto Teknisi</label>
          <input id="f_foto_teknisi" type="file" accept="image/*" />
          <label>Foto KTP</label>
          <input id="f_foto_ktp" type="file" accept="image/*" />
          <label>Foto BPJS Kesehatan</label>
          <input id="f_foto_bpjs_kes" type="file" accept="image/*" />
          <label>Foto BPJS Ketenagakerjaan</label>
          <input id="f_foto_bpjs_ket" type="file" accept="image/*" />
          <label>Foto NPWP</label>
          <input id="f_foto_npwp" type="file" accept="image/*" />
          <label>Foto Kartu Keluarga (KK)</label>
          <input id="f_foto_kk" type="file" accept="image/*" />

          <div class="btn-row">
		<button class="btn btn-primary" type="button" id="btnSave">
			üíæ Simpan
		</button>
		<button class="btn btn-secondary" type="button" id="btnPreview">
			üëÅ Preview Biodata
		</button>
		<button class="btn btn-outline" type="button" id="btnEdit">
			‚úèÔ∏è Edit
		</button>
		<button class="btn btn-outline-red" type="button" id="btnLogout">
			üö™ Logout
		</button>
		</div>

		<p class="note-info">
		*Simpan = kirim data ke Google Sheet. Preview = lihat kartu biodata di bawah.
		Edit = kembali ke form. Logout = kembali ke halaman login teknisi.
		</p>

        </form>
      </section>
    </div>
  </main>

  <!-- PREVIEW BIODATA -->
  <section class="preview-wrapper">
    <div id="previewCard" class="preview-card hidden">
      <div class="preview-header">
        <div class="title-main">BIODATA PEGAWAI</div>
        <div class="title-sub">PT. PUTRA TIMUR JAYA</div>
      </div>
      <div class="preview-grid">
        <div>
          <table class="preview-table">
            <tr><td>Nama Pegawai</td><td id="p_nama"></td></tr>
            <tr><td>Tempat / Tanggal Lahir</td><td id="p_ttl"></td></tr>
            <tr><td>Jenis Kelamin</td><td id="p_jk"></td></tr>
            <tr><td>Pendidikan Terakhir</td><td id="p_pendidikan"></td></tr>
          </table>

          <div class="preview-subtitle">Pendidikan</div>
          <table class="preview-table">
            <tr><td>Formal</td><td id="p_pendidikan_formal"></td></tr>
            <tr><td>Non Formal</td><td id="p_pendidikan_non"></td></tr>
          </table>

          <div class="preview-subtitle">Data Pekerjaan</div>
          <table class="preview-table">
            <tr><td>Status Perkawinan</td><td id="p_status"></td></tr>
            <tr><td>Lokasi Kerja</td><td id="p_lokasi_kerja"></td></tr>
            <tr><td>Posisi Kerja Sebagai</td><td id="p_posisi"></td></tr>
            <tr><td>Divisi</td><td id="p_divisi"></td></tr>
          </table>

          <div class="preview-subtitle">Alamat Tempat Tinggal</div>
          <table class="preview-table">
            <tr><td>Alamat</td><td id="p_alamat_domisili"></td></tr>
            <tr><td>Kelurahan / Desa</td><td id="p_kel_domisili"></td></tr>
            <tr><td>Kecamatan</td><td id="p_kec_domisili"></td></tr>
            <tr><td>Kota / Kabupaten</td><td id="p_kota_domisili"></td></tr>
          </table>

          <div class="preview-subtitle">Kontak & Rekening</div>
          <table class="preview-table">
            <tr><td>Nomor Handphone</td><td id="p_hp"></td></tr>
            <tr><td>Alamat Email</td><td id="p_email"></td></tr>
            <tr><td>Nomor KTP</td><td id="p_ktp"></td></tr>
            <tr><td>Nomor NPWP</td><td id="p_npwp"></td></tr>
            <tr><td>Nama Ibu Kandung</td><td id="p_ibu"></td></tr>
            <tr><td>Nomor Rekening</td><td id="p_norek"></td></tr>
            <tr><td>Nama Bank</td><td id="p_bank"></td></tr>
          </table>

          <div class="preview-subtitle">Alamat Sesuai KTP</div>
          <table class="preview-table">
            <tr><td>Alamat</td><td id="p_alamat_ktp"></td></tr>
            <tr><td>Kelurahan</td><td id="p_kel_ktp"></td></tr>
            <tr><td>Kecamatan</td><td id="p_kec_ktp"></td></tr>
            <tr><td>Kota</td><td id="p_kota_ktp"></td></tr>
          </table>

          <div class="preview-subtitle">BPJS & Keluarga</div>
          <table class="preview-table">
            <tr><td>BPJS Ketenagakerjaan</td><td id="p_bpjs_ket"></td></tr>
            <tr><td>BPJS Kesehatan</td><td id="p_bpjs_kes"></td></tr>
            <tr><td>Nama Istri / Suami</td><td id="p_pasangan"></td></tr>
            <tr><td>Nomor BPJS Istri / Suami</td><td id="p_bpjs_pasangan"></td></tr>
            <tr><td>Nomor Telepon Kerabat</td><td id="p_telp_kerabat"></td></tr>
            <tr><td>Data Anak</td><td id="p_anak"></td></tr>
            <tr><td>Nama Faskes</td><td id="p_faskes"></td></tr>
            <tr><td>Nomor Kartu Keluarga</td><td id="p_kk"></td></tr>
          </table>
        </div>

        <!-- FOTO TEKNISI -->
        <div class="preview-photo-box">
          <img id="p_foto_teknisi" alt="Foto Teknisi" />
        </div>
      </div>

      <p class="note-info" style="margin-top: 10px;">
        *Ini hanya tampilan biodata. Data lengkap + link foto sudah tersimpan di Google Sheet / Drive.
      </p>
    </div>
  </section>

  <script>
    /*********** USER ABSENSI (SAMAKAN DENGAN APLIKASI ABSEN) ***********/
    // Format tiap baris:
    // "username|password|nik|nama|divisi|defaultArea"
    const USER_LINES = [
      // CONTOH:
    "PTJ_Arip007|alvaro007|15889311|ARIP RAHMATULLOH|PIC|CMI",
    "PTJ_15889310|30223023|15889310|UUS SETIADI|PIC|BTJ",
    "PTJ_Bob1990|TE1990|BELUM ADA|ASEP SAEPUDIN|PIC|CMI",
	  "PTJ_Du2ng|Aisha221011|BELUM ADA|DUDUNG SUKMANA|PIC|CMI",
  	"PTJ_Endi1994|Ardila06@@|15889307|ENDI HENDRIANA|PIC|CMI",
	  "PTJ_FirmanFirdaus013|FirmanFirdaus013|16990042|MUHAMMAD FIRMAN DAUD FIRDAUS|PIC|CMI",
	  "PTJ_Vikri012|Vikri0012|BELUM ADA|VIKRI FADHI RAHMAN|PIC|BTJ",
	  "PTJ_Agus25|Ajiz1989|16891202|AGUS|IOAN|NJG",
	  "PTJ_Alfian07|Fianape7|16004674|ALFIAN PERMADI HERDIANSYAH|IOAN|CMI",
	  "PTJ_Anggi13|Zhafran02|15892036|ANGGI SETIAWAN|IOAN|BTJ",
	  "PTJ_Asep125|4sep5ule|15889318|ASEP SULAEMAN|IOAN|NJG",
	  "PTJ_Asep006|Bacilu01|15889328|ASEP SUTARYAT|IOAN|BTJ",
  	"PTJ_Mardian67|Mardian67|16012066|DANDI MARDIANSYAH|IOAN|GNH",
  	"PTJ_Deni017|Denok017|16050949|DENI EGI SAPUTRA|IOAN|CMI",
  	"PTJ_Deni699|Deni@699|16850259|DENI WARDANI|IOAN|BTJ",
  	"PTJ_Deniec15889321|Nanjung2025|15889321|DENIEC GORO SULISTYANTO|IOAN|NJG",
  	"PTJ_DODIMARDANI004|Putija004|15889324|DODI MARDANI|IOAN|CLL",
  	"PTJ_Engkos270|Kostaman80|15889334|ENGKOS KOSTAMAN|IOAN|NJG",
  	"PTJ_Fakhri95|Fakhr1995|15889339|FAKHRI RASYAD RAMDHANI|IOAN|CMI",
  	"PTJ_Giant77|Telkom77|15889330|GIAN KRISTAL|IOAN|NJG",
  	"PTJ_INDRA999|270310Aa|16921681|INDRA PRATAMA|IOAN|NJG",
  	"PTJ_Nugraha24|Street24|15882130|INSAN NUGRAHA|IOAN|CMI",
  	"PTJ_Irfanm019|putija@1|16950710|IRFAN MAULANA|IOAN|CMI",
  	"PTJ_Irfan16022301|Bacilu01|16022301|IRFAN NURJAMAN|IOAN|BTJ",
  	"PTJ_Juli86|juli0786|15889309|JULI SURYANA|IOAN|NJG",
  	"PTJ_Nazli313|arkan2015|15889313|NAZLI RUDI YANTO|IOAN|CMI",
  	"PTJ_Rendyherwansyah|putija@2025|15902465|RENDI HERWANSYAH|IOAN|GNH",
  	"PTJ_Galing28|galing2810|15901086|RIDWAN RISWANDI|IOAN|NJG",
  	"PTJ_Sahibul87|ahyad87|15889319|SAHIBUL AHYAD|IOAN|CMI",
  	"PTJ_Taryana2004|atar2004|15889316|TARYANA|IOAN|CMI",
  	"PTJ_TAUFIK046|PUTIJA046|15889345|TAUFIK HIDAYAT|IOAN|NJG",
  	"PTJ_Tisna05|241103rm|15889326|TISNA|IOAN|BTJ",
  	"PTJ_Ujang77|uchin2877|15889333|UJANG MUKSIN|IOAN|CMI",
  	"PTJ_Yogi28|Yogi2828|16950715|YOGI TJANDRA FERNANDO|IOAN|CMI",
  	"PTJ_YUNUS696|Absen696|15900696|YUNUS HITOTUN|IOAN|CMI",
    "PTJ_Aditya129|aditya0707|BELUM ADA|ADITYA RAMDAN SYARIF|PSB|BTJ",
    "PTJ_Yusup16942254|putija@2028|16942254|AHMAD MAULANA YUSUP|PSB|BTJ",
    "PTJ_Ahmad29040|zaki290406|BELUM ADA|AHMAD ZAQI|PSB|CMI",
    "PTJ_Andi027|mspeed27|16952753|ANDI RAMDANI|PSB|CMI",
    "PTJ_ANDIAN666|123Asik#|BELUM ADA|ANDIAN WAHYUDI|PSB|CLL",
    "PTJ_Ardian17|deci12345|BELUM ADA|ARDIAN HAFIDZ|PSB|BTJ",
    "PTJ_Arga003|Arga1603|16901188|ARGA ALI SANTIAJI|PSB|NJG",
    "PTJ_Aria015|Aria2025|16911316|ARIA RIDWANTO|PSB|CLL",
    "PTJ_Asep0797|Telkom0797|16974185|ASEP SAEPUL HIDAYAT|PSB|GNH",
    "PTJ_Dedi08|RizkiRizam12|16820493|DEDI WINARDI|PSB|NJG",
    "PTJ_Enjang93|Hardi1993|16931851|ENJANG HARDI|PSB|CMI",
    "PTJ_Febby90|putija25|16901210|FEBBY REZA NURHUDA|PSB|CLL",
    "PTJ_IbnuDcs|Kududiuye|16022542|IBNU DZAHABI|PSB|CMI",
    "PTJ_Bowo182|makemanah85|16850029|KHOERUDIN PRABOWO|PSB|CMI",
    "PTJ_Ilyas1289|Rilkay2018|15891521|KM ILYAS AKBAR|PSB|NJG",
    "PTJ_PadiiiL7|padilada22|BELUM ADA|LUTFHIAN ALFADHILA SURYANA|PSB|CMI",
    "PTJ_Mahpud0611|rendekidul01|16022545|MAHPUD SOPIAN|PSB|CMI",
    "PTJ_MARTONO13|INDONESIA#2024|16004766|MARTONO|PSB|CMI",
    "PTJ_MASKUR13|Maskur130700|16002023|MASKUR|PSB|CLL",
    "PTJ_rifan07|cimahicity5|Belum Ada|MOCH RIFAN FAKHRIZAL|PSB|CMI",
    "PTJ_Hasan001|Hasan123|BELUM ADA|MUHAMMAD HASAN|PSB|CMI",
    "PTJ_Imam202002|Ghozali2002|16022546|MUHAMMAD IMAM GHOZALI|PSB|CLL",
    "PTJ_NRyadi33|Nryadi0303|16995419|NURYADI|PSB|NJG",
    "PTJ_Purnama07|Purnama76|BELUM ADA|PURNAMA RAMDANI|PSB|CLL",
    "PTJ_Resky022|Telkom2296|16963327|RESKY ARDIANSYAH|PSB|CMI",
    "PTJ_rmaulana952|bedahciwok001|16953587|RIZWAN MAULANA|PSB|BTJ",
    "PTJ_Sandi014|sandiwah45|BELUM ADA|SANDI WAHYUDI|PSB|BTJ",
    "PTJ_Sanji017|qweasd123|BELUM ADA|SANJI|PSB|CMI",
    "PTJ_Sarijan01|Sarijan12|16901534|SARIJAN|PSB|CLL",
    "PTJ_SOLIHIN1933|PERSIB1933|16942904|SOLIHIN|PSB|GNH",
    "PTJ_Syamsul382|BantuFO38|16022056|SYAMSUL BAHRI|PSB|CMI",
    "PTJ_Tubagus13|Tubagus13|16963926|TUBAGUS BUKIYANTORO|PSB|BTJ",
     "PTJ_Ujang9933|Almera0607|Belum ada|UJANG ROHIMAT|PSB|BTJ",
  	"PTJ_BILAL23|bilal1234|16994703|BILAL FISSABILILLAH|PSB|BTJ",
  	"PTJ_Robi1121|slipknot.1960|BELUM ADA|AZIS ROBIANSYAH|PSB|CLL",
  	"PTJ_@PilihanHelaWeh|16870758|16870758|UJANG SUMPENA|PSB|CMI",
  	"PTJ_Zacky123|Kadungora05|BELUM ADA|MOCH ZACKY AZKARI|PSB|BTJ",
  	"PTJ_Ryanfir72|ryanfi72|BELUM ADA|RIYAN FIRMANSAH|PSB|CMI",
  	"PTJ_Alva30|Sunang30|16991540|MUHAMMAD ALVA RIZKY|IOAN|CMI",
  	"PTJ_Dikiw15|Dikiw12345|BELUM ADA|DIKI WAHYUDI SETIAWAN|PSB|CLL",
  	"PTJ_Hermawan19|persija19|BELUM ADA|HERMAWAN|PSB|CLL",
  	"PTJ_rasyid2007|satusampai9|BELUM ADA|ABDUL RASYID AHMADI RAZZAQ|PSB|NJG",
  	"PTJ_Hendra303|PTJ_Hendra303|15889332|HENDRA PERMANA|IOAN|NJG",
  	"PTJ_Heri2025|cimahi2025|16770224|HERI NURDIANA SANTOSA|PSB|NJG",
  	"PTJ_WAHENDRA|Project01|BELUM ADA|WAHENDRA|PIC|CMI",
  	"PTJ_ADI SOPIAN|Project01|15889303|ADI SOPIAN|PIC|CMI",
  	"PTJ_Dicky029|Dicky029|16974122|DICKY IRAWAN SONJAYA|PSB|CMI",
  	"PTJ_GAGAN SUHERMAN|Project01|BELUM ADA|GAGAN SUHERMAN|PROJEK|CMI",
  	"PTJ_DEDE YUSUP|Project01|BELUM ADA|DEDE YUSUP|PROJEK|BTJ",
  	"PTJ_RAIHAN|Project01|BELUM ADA|MOCHAMAD RAIHAN ARYA AGUNG|PROJEK|BTJ",
  	"PTJ_RESTU|Project01|BELUM ADA|RESTU|PROJEK|CMI",
  	"PTJ_RIFKI|Project01|BELUM ADA|RIFKI|PROJEK|CMI",
  	"PTJ_Ambar71R|Rawing71|15889320|AMBARYADI GUNAWAN|PSB|NJG",
  	"PTJ_AGUNGINDRA014|agungindra041498|16982268|AGUNG INDRA LESMANA|PSB|BTJ",
  	"PTJ_bilalfajri27|bilalfajri2005|belum ada|MUHAMAD BILAL FAJRI|PSB|CMI",
  	"PTJ_Pentingberkah|Ganjar83|15889317|GANJAR SAEPUDIN|IOAN|CMI",
  	"PTJ_ADE22|layadmos2312|16002299|ADE SOPIYAN|IOAN|KNG",
  	"PTJ_Nana007|tamanana6661|16022091|NANA ADITAMA|IOAN|KNG",
  	"PTJ_Zul78|Aqi11aram|16780156|ZULHAM EFFENDI ZAS|PSB|NJG",
  	"PTJ_Opi012|Toren1234|16942370|OPIK IRAWAN|IOAN|KNG",
  	"PTJ_Refli012|Putija@12|16023016|REFLI PITDATULLOH|PSB|CMI",
  	"PTJ_Puad98|Telkom123|16983641|PUAD TOHAWI|PSB|CLL",
  	"PTJ_Pathudin013|Azalea13|16962281|Pathudin|IOAN|KNG",
  	"PTJ_Azmi15|Telkom123|16962282|Azmi rifai|IOAN|KNG",
  	"PTJ_ErikoRamdani001|Telkom123|BELUM ADA|ERICO RAMDANI|PSB|CLL",
  	"PTJ_Febri24|Annuaink100|16900564|FEBRI RIYANDI|IOAN|KNG",
  	"PTJ_Ari0079|11223344|16050178|ARI ANGGARA|IOAN|KNG",
  	"PTJ_Zahdan17|461147zz|16800322|AGUS SAHDAN|IOAN|KNG",
  	"PTJ_DANI001|PTJKNG001|16022092|MUHAMAD RAMDANI|PSB|KNG",
	  "PTJ_IMAM001|PTJKNG001|16901520|MOCHAMMAD IMAM TAOFIK|PSB|KNG",
  	"PTJ_IPAN001|PTJKNG001|16050679|IPAN GILANG RAMADAN|PSB|KNG",
  	"PTJ_RAFI001|PTJKNG001|16050313|RAFI ARIEL NUGRAHA|PSB|KNG",
  	"PTJ_SECHAN001|PTJKNG001|16040915|SECHAN BUKHORI|PSB|KNG",
  	"PTJ_AGUS001|PTJKNG001|16031512|AGUS HAMDANI|PSB|KNG",
  	"PTJ_BAGUS001|PTJKNG001|16003512|BAGUS PRASETIO|PSB|KNG",
  	"PTJ_FAHRY001|PTJKNG001|Belum Ada|FAHRY ADITYA ASRIZAL|PSB|KNG",
  	"PTJ_DADI001|PTJKNG001|16952927|DADI APRIADI|PSB|KNG",
  	"PTJ_IRFAN001|PTJKNG001|16060537|MOHAMMAD IRFAN HAKIM|PSB|KNG",
  	"PTJ_SYAHRUL001|PTJKNG001|16050886|SYAHRUL RAMDHAN AT'THORIQ|PSB|KNG",
  	"PTJ_DONI001|PTJKNG001|16974498|MUHAMAD RAMDONI|PSB|KNG",
  	"PTJ_APRI001|PTJKNG001|Belum Ada|A CANDRA KOSWARA|PROJEK|KNG",
  	"PTJ_AZHAR001|PTJKNG001|16973839|M. CHOIRUL AZHARI ROSID|PIC|KNG",
  	"PTJ_DADINUR001|PTJKNG001|16890989|DADI NURYADI|PIC|KNG",
  	"PTJ_Dendi@01|1052002|BELUM ADA|DENDI MANDIRI|PSB|BTJ",
  	"PTJ_Miky11|Saya171194|16942855|MICKY MARDIANA|IOAN|KNG",
  	"PTJ_Taufik024|Kuningan24|15893582|TAUFIK AKBAR|IOAN|KNG",
  	"PTJ_ZEMMY|putija2025|BELUM ADA|ZEEMY|PIC|CMI",
  	"PTJ_DANI|Project01|16850676|DANI|PROJEK|CMI",
  	"PTJ_ADITTIYA08|80621|16013886|ADITTIYA HERDI|PSB|CMI"
      // >>>>>>> GANTI / TAMBAH dengan daftar user asli dari aplikasi absensi <<<<<<
    ];
    const USERS = USER_LINES.map(line => {
      const [username, password, nik, nama, divisi, defaultArea] = line.split("|");
      return { username, password, nik, nama, divisi, defaultArea };
    });

    // URL web app Apps Script BIODATA
    const WEB_APP_URL =
      "https://script.google.com/macros/s/AKfycbxAnoRfp3dIUiKJT9KF03RweouXnXUVFvSgetOUmvnnOm7eOrdqKVFjfna75TIg4Vg/exec";

    let loggedUser = null;

    const loginUserInput = document.getElementById("loginUser");
    const loginPassInput = document.getElementById("loginPass");
    const loginCard = document.getElementById("loginCard");
    const bioCard = document.getElementById("bioCard");

    document.getElementById("btnLogin").addEventListener("click", () => {
      const u = loginUserInput.value.trim();
      const p = loginPassInput.value.trim();

      if (!u || !p) {
        alert("User ID dan password tidak boleh kosong.");
        return;
      }

      const found = USERS.find(
        x => x.username.toLowerCase() === u.toLowerCase() && x.password === p
      );

      if (!found) {
        alert("User ID atau password salah.");
        return;
      }

      loggedUser = found;
      alert("Login berhasil. Selamat datang, " + found.nama + "!");

      // tampilkan form biodata, sembunyikan card login
      loginCard.classList.add("hidden");
      bioCard.classList.remove("hidden");

      // isi otomatis beberapa field
      document.getElementById("f_nama").value = found.nama || "";
      document.getElementById("f_lokasi_kerja").value = found.defaultArea || "";
      document.getElementById("f_divisi").value = found.divisi || "";
    });

    // Helper: convert file input ke base64
    function fileToBase64(inputEl) {
      return new Promise(resolve => {
        const file = inputEl.files && inputEl.files[0];
        if (!file) {
          resolve("");
          return;
        }
        const reader = new FileReader();
        reader.onload = e => {
          const result = e.target.result || "";
          const base64 = result.split(",")[1] || "";
          resolve(base64);
        };
        reader.readAsDataURL(file);
      });
    }

    // Preview foto teknisi di kartu biodata
    const fotoInput = document.getElementById("f_foto_teknisi");
    const fotoPreview = document.getElementById("p_foto_teknisi");
    fotoInput.addEventListener("change", () => {
      const file = fotoInput.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = e => { fotoPreview.src = e.target.result; };
      reader.readAsDataURL(file);
    });

    // Submit form biodata
	(window.addEventListener("DOMContentLoaded", function(){ ... })):
	
	window.addEventListener("DOMContentLoaded", function(){ ... });

         const bioForm = document.getElementById("bioForm");
    const previewCard = document.getElementById("previewCard");
    const btnSave = document.getElementById("btnSave");
    const btnPreview = document.getElementById("btnPreview");
    const btnEdit = document.getElementById("btnEdit");
    const btnLogout = document.getElementById("btnLogout");

    // helper ambil nilai field
    const getVal = id => (document.getElementById(id)?.value || "").trim();

    // kumpulkan semua field biodata
    function collectFields() {
      return {
        nama: getVal("f_nama"),
        ttl: getVal("f_ttl"),
        jk: getVal("f_jk"),
        pendidikan: getVal("f_pendidikan"),
        pendidikanFormal: getVal("f_pendidikan_formal"),
        pendidikanNon: getVal("f_pendidikan_non"),
        status: getVal("f_status"),
        lokasiKerja: getVal("f_lokasi_kerja"),
        posisi: getVal("f_posisi"),
        divisi: getVal("f_divisi"),
        alamatDomisili: getVal("f_alamat_domisili"),
        kelDomisili: getVal("f_kel_domisili"),
        kecDomisili: getVal("f_kec_domisili"),
        kotaDomisili: getVal("f_kota_domisili"),
        hp: getVal("f_hp"),
        email: getVal("f_email"),
        ktp: getVal("f_ktp"),
        npwp: getVal("f_npwp"),
        ibu: getVal("f_ibu"),
        norek: getVal("f_norek"),
        bank: getVal("f_bank"),
        alamatKtp: getVal("f_alamat_ktp"),
        kelKtp: getVal("f_kel_ktp"),
        kecKtp: getVal("f_kec_ktp"),
        kotaKtp: getVal("f_kota_ktp"),
        bpjsKet: getVal("f_bpjs_ket"),
        bpjsKes: getVal("f_bpjs_kes"),
        pasangan: getVal("f_pasangan"),
        bpjsPasangan: getVal("f_bpjs_pasangan"),
        telpKerabat: getVal("f_telp_kerabat"),
        anak: getVal("f_anak"),
        faskes: getVal("f_faskes"),
        kk: getVal("f_kk")
      };
    }

    // isi kartu preview dari object fields
    function fillPreview(fields) {
      document.getElementById("p_nama").textContent = fields.nama;
      document.getElementById("p_ttl").textContent = fields.ttl;
      document.getElementById("p_jk").textContent = fields.jk;
      document.getElementById("p_pendidikan").textContent = fields.pendidikan;
      document.getElementById("p_pendidikan_formal").textContent = fields.pendidikanFormal;
      document.getElementById("p_pendidikan_non").textContent = fields.pendidikanNon;

      document.getElementById("p_status").textContent = fields.status;
      document.getElementById("p_lokasi_kerja").textContent = fields.lokasiKerja;
      document.getElementById("p_posisi").textContent = fields.posisi;
      document.getElementById("p_divisi").textContent = fields.divisi;

      document.getElementById("p_alamat_domisili").textContent = fields.alamatDomisili;
      document.getElementById("p_kel_domisili").textContent = fields.kelDomisili;
      document.getElementById("p_kec_domisili").textContent = fields.kecDomisili;
      document.getElementById("p_kota_domisili").textContent = fields.kotaDomisili;

      document.getElementById("p_hp").textContent = fields.hp;
      document.getElementById("p_email").textContent = fields.email;
      document.getElementById("p_ktp").textContent = fields.ktp;
      document.getElementById("p_npwp").textContent = fields.npwp;
      document.getElementById("p_ibu").textContent = fields.ibu;
      document.getElementById("p_norek").textContent = fields.norek;
      document.getElementById("p_bank").textContent = fields.bank;

      document.getElementById("p_alamat_ktp").textContent = fields.alamatKtp;
      document.getElementById("p_kel_ktp").textContent = fields.kelKtp;
      document.getElementById("p_kec_ktp").textContent = fields.kecKtp;
      document.getElementById("p_kota_ktp").textContent = fields.kotaKtp;

      document.getElementById("p_bpjs_ket").textContent = fields.bpjsKet;
      document.getElementById("p_bpjs_kes").textContent = fields.bpjsKes;
      document.getElementById("p_pasangan").textContent = fields.pasangan;
      document.getElementById("p_bpjs_pasangan").textContent = fields.bpjsPasangan;
      document.getElementById("p_telp_kerabat").textContent = fields.telpKerabat;
      document.getElementById("p_anak").textContent = fields.anak;
      document.getElementById("p_faskes").textContent = fields.faskes;
      document.getElementById("p_kk").textContent = fields.kk;
    }

    // ambil semua foto sebagai base64
    async function collectPhotos() {
      const [
        b64FotoTeknisi,
        b64FotoKtp,
        b64FotoBpjsKes,
        b64FotoBpjsKet,
        b64FotoNpwp,
        b64FotoKk
      ] = await Promise.all([
        fileToBase64(document.getElementById("f_foto_teknisi")),
        fileToBase64(document.getElementById("f_foto_ktp")),
        fileToBase64(document.getElementById("f_foto_bpjs_kes")),
        fileToBase64(document.getElementById("f_foto_bpjs_ket")),
        fileToBase64(document.getElementById("f_foto_npwp")),
        fileToBase64(document.getElementById("f_foto_kk"))
      ]);

      return {
        fotoTeknisi: b64FotoTeknisi,
        fotoKtp: b64FotoKtp,
        fotoBpjsKes: b64FotoBpjsKes,
        fotoBpjsKet: b64FotoBpjsKet,
        fotoNpwp: b64FotoNpwp,
        fotoKk: b64FotoKk
      };
    }

    // --- PREVIEW ---
    btnPreview.addEventListener("click", () => {
      const fields = collectFields();
      fillPreview(fields);
      previewCard.classList.remove("hidden");
      // scroll ke preview
      window.scrollTo({ top: previewCard.offsetTop - 80, behavior: "smooth" });
    });

    // --- SIMPAN KE GOOGLE SHEET ---
    btnSave.addEventListener("click", async () => {
      if (!loggedUser) {
        alert("Silakan login teknisi terlebih dahulu.");
        return;
      }

      const fields = collectFields();
      const photos = await collectPhotos();

      const payload = {
        mode: "biodata",
        user: {
          username: loggedUser.username,
          nik: loggedUser.nik,
          nama: loggedUser.nama,
          divisi: loggedUser.divisi,
          defaultArea: loggedUser.defaultArea
        },
        fields,
        photos
      };

      try {
        const res = await fetch(WEB_APP_URL, {
          method: "POST",
          body: JSON.stringify(payload)
        });
        const text = await res.text();
        alert("Respon server: " + text);
      } catch (err) {
        alert("Gagal kirim ke Google Sheet: " + err.message);
      }
    });

    // --- EDIT (sembunyikan preview, tetap di form) ---
    btnEdit.addEventListener("click", () => {
      previewCard.classList.add("hidden");
      window.scrollTo({ top: bioCard.offsetTop - 80, behavior: "smooth" });
    });

    // --- LOGOUT ---
    btnLogout.addEventListener("click", () => {
      loggedUser = null;
      bioForm.reset();
      if (fotoPreview) fotoPreview.src = "";
      previewCard.classList.add("hidden");

      // tampilkan lagi form login
      loginCard.classList.remove("hidden");
      bioCard.classList.add("hidden");
      loginUserInput.value = "";
      loginPassInput.value = "";
      alert("Anda sudah logout.");
    });
  </script>
</body>
</html>
