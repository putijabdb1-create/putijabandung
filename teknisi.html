<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Login Teknisi â€“ PT PUTRA TIMUR JAYA</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{font-family:Arial;background:#020617;color:#fff;margin:0}
.container{max-width:1100px;margin:auto;padding:20px}
.card{background:#020617;border:1px solid #1f2937;border-radius:12px;padding:16px;margin-bottom:16px}
h2{margin:0 0 10px}
label{font-size:12px;margin-top:6px;display:block}
input,select,textarea{
  width:100%;padding:8px;border-radius:8px;
  background:#020617;color:#fff;border:1px solid #374151
}
input[readonly]{opacity:.6;cursor:not-allowed}
.row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.btn{padding:8px 14px;border-radius:20px;border:none;cursor:pointer}
.btn-primary{background:#2563eb;color:#fff}
.btn-danger{background:#dc2626;color:#fff}
img.preview{max-width:120px;margin-top:6px;border-radius:8px;border:1px solid #333}
.status{font-size:12px;margin-top:8px}

@media print{
  body{background:#fff;color:#000}
  .card,.btn{display:none}
  .print-page{display:block}
}
.print-page{
  display:none;
  width:210mm;
  min-height:297mm;
  background:#fff;color:#000;
  padding:15mm;
  page-break-after:always;
}
.print-page table{width:100%;border-collapse:collapse;font-size:11px}
.print-page td{border:1px solid #000;padding:4px}
.page-num{position:absolute;bottom:10mm;right:15mm;font-size:10px}
</style>
</head>

<body>
<div class="container">

<!-- LOGIN -->
<div class="card">
<h2>Login Teknisi</h2>
<label>User ID</label><input id="loginUser">
<label>Password</label><input id="loginPass" type="password">
<button class="btn btn-primary" onclick="login()">Login</button>
<div id="loginStatus" class="status"></div>
</div>

<!-- FORM -->
<div class="card" id="formCard" style="display:none">
<h2>Form Biodata</h2>

<label>User ID</label><input id="userId" readonly>
<label>NIK</label><input id="nik" readonly>
<label>Nama Pegawai</label><input id="namaPegawai" readonly>

<div class="row">
<div>
<label>Jenis Kelamin</label>
<select id="jenisKelamin">
<option value="">Pilih</option>
<option>Laki-laki</option>
<option>Perempuan</option>
</select>
</div>
<div>
<label>Status Perkawinan</label>
<select id="statusPerkawinan">
<option value="">Pilih</option>
<option>Kawin</option>
<option>Belum Kawin</option>
<option>Cerai</option>
</select>
</div>
</div>

<label>Tempat / Tanggal Lahir</label><input id="ttl">

<div class="row">
<div><label>Lokasi Kerja</label><input id="lokasiKerja" readonly></div>
<div><label>Posisi Kerja</label><input id="posisiKerja" readonly></div>
</div>

<label>Divisi</label><input id="divisi" readonly>

<label>SIM C</label><input id="simC">

<hr>

<h3>FOTO</h3>

<label>Foto Teknisi</label><input type="file" id="fotoTeknisi"><img id="pFotoTeknisi" class="preview">

<label>Foto KTP</label><input type="file" id="fotoKtp"><img id="pFotoKtp" class="preview">

<label>Foto NPWP</label><input type="file" id="fotoNpwp"><img id="pFotoNpwp" class="preview">

<label>Foto SIM C</label><input type="file" id="fotoSim"><img id="pFotoSim" class="preview">

<label>Foto BPJS Kesehatan</label><input type="file" id="fotoBpjsKes"><img id="pFotoBpjsKes" class="preview">

<label>Foto BPJS Ketenagakerjaan</label><input type="file" id="fotoBpjsKet"><img id="pFotoBpjsKet" class="preview">

<label>Foto KK</label><input type="file" id="fotoKk"><img id="pFotoKk" class="preview">

<button class="btn btn-primary" onclick="save()">ðŸ’¾ Simpan</button>
<button class="btn btn-primary" onclick="preview()">ðŸ‘€ Preview</button>
<button class="btn btn-danger" onclick="logout()">Logout</button>

<div id="formStatus" class="status"></div>
</div>

<!-- PREVIEW -->
<div class="print-page" id="printArea">
<h3 style="text-align:center">BIODATA PEGAWAI<br>PT PUTRA TIMUR JAYA</h3>
<table>
<tr><td>Nama</td><td id="pvNama"></td></tr>
<tr><td>TTL</td><td id="pvTtl"></td></tr>
<tr><td>Jenis Kelamin</td><td id="pvJk"></td></tr>
<tr><td>Status</td><td id="pvStatus"></td></tr>
<tr><td>SIM C</td><td id="pvSim"></td></tr>
<tr><td>Foto</td><td><img id="pvFoto" style="max-width:100px"></td></tr>
</table>
<div class="page-num">1/1</div>
</div>

</div>

<script>
const WEB_APP_URL="PASTE_URL_WEBAPP_KAMU";

const USERS=[
 {u:"PTJ_Arip007",p:"alvaro007",nik:"15889311",nama:"ARIP RAHMATULLOH",lokasi:"CMI",posisi:"BASIC_TEKNISI",divisi:"PIC"}
];

let currentUser=null;
let foto={};

function login(){
 const u=loginUser.value,p=loginPass.value;
 const user=USERS.find(x=>x.u===u&&x.p===p);
 if(!user){loginStatus.textContent="Login gagal";return}
 currentUser=user;
 formCard.style.display="block";
 userId.value=user.u;
 nik.value=user.nik;
 namaPegawai.value=user.nama;
 lokasiKerja.value=user.lokasi;
 posisiKerja.value=user.posisi;
 divisi.value=user.divisi;
 loadData();
}

function logout(){location.reload()}

function bind(id,prev){
 document.getElementById(id).onchange=e=>{
  const r=new FileReader();
  r.onload=x=>{
   foto[id]=x.target.result;
   document.getElementById(prev).src=x.target.result;
  };
  r.readAsDataURL(e.target.files[0]);
 }
}
bind("fotoTeknisi","pFotoTeknisi");
bind("fotoKtp","pFotoKtp");
bind("fotoNpwp","pFotoNpwp");
bind("fotoSim","pFotoSim");
bind("fotoBpjsKes","pFotoBpjsKes");
bind("fotoBpjsKet","pFotoBpjsKet");
bind("fotoKk","pFotoKk");

async function save(){
 formStatus.textContent="Menyimpan...";
 await fetch(WEB_APP_URL,{
  method:"POST",
  headers:{"Content-Type":"text/plain;charset=utf-8"},
  body:JSON.stringify({
   mode:"saveBiodata",
   user:currentUser,
   biodata:{
    namaPegawai:namaPegawai.value,
    ttl:ttl.value,
    jenisKelamin:jenisKelamin.value,
    statusPerkawinan:statusPerkawinan.value,
    simC:simC.value
   },
   foto:foto.fotoTeknisi,
   fotoKtp:foto.fotoKtp,
   fotoNpwp:foto.fotoNpwp,
   fotoBpjsKes:foto.fotoBpjsKes,
   fotoBpjsKet:foto.fotoBpjsKet,
   fotoKk:foto.fotoKk,
   fotoSim:foto.fotoSim
  })
 });
 formStatus.textContent="âœ” BERHASIL DISIMPAN";
}

async function loadData(){
 const r=await fetch(WEB_APP_URL,{
  method:"POST",
  headers:{"Content-Type":"text/plain;charset=utf-8"},
  body:JSON.stringify({mode:"getBiodata",username:currentUser.u})
 });
 const j=JSON.parse(await r.text());
 if(j.found){
  ttl.value=j.biodata.ttl||"";
  jenisKelamin.value=j.biodata.jenisKelamin||"";
  statusPerkawinan.value=j.biodata.statusPerkawinan||"";
 }
}

function preview(){
 pvNama.textContent=namaPegawai.value;
 pvTtl.textContent=ttl.value;
 pvJk.textContent=jenisKelamin.value;
 pvStatus.textContent=statusPerkawinan.value;
 pvSim.textContent=simC.value;
 pvFoto.src=foto.fotoTeknisi||"";
 printArea.style.display="block";
 window.print();
}
</script>
</body>
</html>
