<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Biodata Teknisi â€“ PT PUTRA TIMUR JAYA</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{font-family:Arial,Helvetica,sans-serif;background:#f3f4f6;margin:0}
.container{max-width:1100px;margin:auto;padding:16px}
.card{background:#fff;border-radius:8px;padding:16px;margin-bottom:16px;box-shadow:0 2px 8px rgba(0,0,0,.1)}
h2{margin:0 0 8px}
label{font-size:13px;font-weight:600}
input,select,textarea{width:100%;padding:6px;margin:4px 0 10px}
textarea{resize:vertical}
.row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
.readonly{background:#e5e7eb}
button{padding:8px 14px;border:none;border-radius:6px;cursor:pointer}
.btn-primary{background:#2563eb;color:#fff}
.btn-secondary{background:#6b7280;color:#fff}
.btn-danger{background:#dc2626;color:#fff}
.preview-img{max-width:120px;border:1px solid #999;margin-top:6px}
.hidden{display:none}
</style>
</head>

<body>
<div class="container">

<!-- LOGIN -->
<div class="card">
<h2>Login Teknisi</h2>
<div class="row">
  <div>
    <label>User ID</label>
    <input id="loginUser">
  </div>
  <div>
    <label>Password</label>
    <input id="loginPass" type="password">
  </div>
</div>
<button class="btn-primary" onclick="loginTeknisi()">Login</button>
<p id="loginStatus"></p>
</div>

<!-- FORM -->
<div class="card hidden" id="formCard">
<h2>Form Biodata Teknisi</h2>

<label>User ID</label>
<input id="userId" class="readonly" readonly>

<label>NIK</label>
<input id="nik" class="readonly" readonly>

<label>Nama Pegawai</label>
<input id="namaPegawai" class="readonly" readonly>

<div class="row">
<div>
<label>Lokasi Kerja</label>
<input id="lokasiKerja" class="readonly" readonly>
</div>
<div>
<label>Posisi Kerja</label>
<input id="posisiKerja" class="readonly" readonly>
</div>
</div>

<label>Divisi</label>
<input id="divisi" class="readonly" readonly>

<hr>

<label>Tempat / Tanggal Lahir</label>
<input id="ttl">

<div class="row">
<div>
<label>Jenis Kelamin</label>
<select id="jenisKelamin">
<option value="">-- Pilih --</option>
<option>Laki-laki</option>
<option>Perempuan</option>
</select>
</div>
<div>
<label>Status Perkawinan</label>
<select id="statusPerkawinan">
<option value="">-- Pilih --</option>
<option>Kawin</option>
<option>Belum Kawin</option>
<option>Cerai</option>
</select>
</div>
</div>

<label>Pendidikan Terakhir</label>
<input id="pendidikanAkhir">

<label>Pendidikan Formal</label>
<textarea id="pendFormal" rows="3"></textarea>

<label>Pendidikan Non Formal</label>
<textarea id="pendNonFormal" rows="2"></textarea>

<hr>

<label>Alamat Domisili</label>
<textarea id="alamatDomisili" rows="2"></textarea>

<div class="row">
<div><label>Kelurahan</label><input id="domKel"></div>
<div><label>Kecamatan</label><input id="domKec"></div>
</div>

<label>Kota / Kabupaten</label>
<input id="domKota">

<hr>

<div class="row">
<div><label>No HP</label><input id="noHp"></div>
<div><label>Email</label><input id="email"></div>
</div>

<div class="row">
<div><label>No KTP</label><input id="noKtp"></div>
<div><label>No NPWP</label><input id="noNpwp"></div>
</div>

<label>Nama Ibu Kandung</label>
<input id="namaIbu">

<div class="row">
<div><label>No Rekening</label><input id="noRekening"></div>
<div><label>Nama Bank</label><input id="namaBank"></div>
</div>

<hr>

<label>Alamat Sesuai KTP</label>
<textarea id="ktpAlamat" rows="2"></textarea>

<div class="row">
<div><label>Kelurahan</label><input id="ktpKel"></div>
<div><label>Kecamatan</label><input id="ktpKec"></div>
</div>

<label>Kota</label>
<input id="ktpKota">

<hr>

<div class="row">
<div><label>BPJS Ketenagakerjaan</label><input id="bpjsKet"></div>
<div><label>BPJS Kesehatan</label><input id="bpjsKes"></div>
</div>

<label>Nama Istri / Suami</label>
<input id="namaPasangan">

<label>No BPJS Istri / Suami</label>
<input id="bpjsPasangan">

<label>No Telp Kerabat</label>
<input id="telpKerabat">

<label>Data Anak</label>
<textarea id="dataAnak" rows="2"></textarea>

<label>Nama Faskes</label>
<input id="namaFaskes">

<label>No KK</label>
<input id="noKk">

<hr>

<h3>Upload Foto</h3>

<label>Foto Teknisi</label>
<input type="file" id="fotoTeknisi" accept="image/*">
<img id="pFotoTeknisi" class="preview-img">

<label>Foto KTP</label>
<input type="file" id="fotoKtp" accept="image/*">
<img id="pFotoKtp" class="preview-img">

<label>Foto KK</label>
<input type="file" id="fotoKk" accept="image/*">
<img id="pFotoKk" class="preview-img">

<label>Foto NPWP</label>
<input type="file" id="fotoNpwp" accept="image/*">
<img id="pFotoNpwp" class="preview-img">

<label>Foto SIM C</label>
<input type="file" id="fotoSim" accept="image/*">
<img id="pFotoSim" class="preview-img">

<label>Foto BPJS Kesehatan</label>
<input type="file" id="fotoBpjsKes" accept="image/*">
<img id="pFotoBpjsKes" class="preview-img">

<label>Foto BPJS Ketenagakerjaan</label>
<input type="file" id="fotoBpjsKet" accept="image/*">
<img id="pFotoBpjsKet" class="preview-img">

<br><br>
<button class="btn-primary" onclick="saveBiodata()">Simpan</button>
<button class="btn-secondary" onclick="logout()">Logout</button>
<p id="formStatus"></p>
</div>

</div>

<script>
/* ====== KONFIGURASI ====== */
const WEB_APP_URL = "GANTI_DENGAN_URL_WEBAPP_KAMU";

/* ====== USER SAMPLE ====== */
const USERS=[{username:"PTJ_TEST",password:"123",nik:"12345",nama:"TEST USER",divisi:"IOAN",defaultArea:"CMI",posisi:"TEKNISI"}];

let currentUser=null;
let photos={};

function loginTeknisi(){
 const u=document.getElementById("loginUser").value;
 const p=document.getElementById("loginPass").value;
 const user=USERS.find(x=>x.username===u&&x.password===p);
 if(!user){loginStatus.textContent="Login gagal";return}
 currentUser=user;
 loginStatus.textContent="Login berhasil";
 formCard.classList.remove("hidden");

 userId.value=user.username;
 nik.value=user.nik;
 namaPegawai.value=user.nama;
 lokasiKerja.value=user.defaultArea;
 divisi.value=user.divisi;
 posisiKerja.value=user.posisi||"";
}

function logout(){location.reload()}

function fileToBase64(id,preview,key){
 document.getElementById(id).onchange=e=>{
  const r=new FileReader();
  r.onload=()=>{photos[key]=r.result;document.getElementById(preview).src=r.result}
  r.readAsDataURL(e.target.files[0]);
 }
}

fileToBase64("fotoTeknisi","pFotoTeknisi","foto");
fileToBase64("fotoKtp","pFotoKtp","fotoKtp");
fileToBase64("fotoKk","pFotoKk","fotoKk");
fileToBase64("fotoNpwp","pFotoNpwp","fotoNpwp");
fileToBase64("fotoSim","pFotoSim","fotoSim");
fileToBase64("fotoBpjsKes","pFotoBpjsKes","fotoBpjsKes");
fileToBase64("fotoBpjsKet","pFotoBpjsKet","fotoBpjsKet");

async function saveBiodata(){
 formStatus.textContent="Menyimpan...";
 const data={
  mode:"saveBiodata",
  user:currentUser,
  biodata:{
   ttl:ttl.value,jenisKelamin:jenisKelamin.value,statusPerkawinan:statusPerkawinan.value,
   pendidikanAkhir:pendidikanAkhir.value,pendFormal:pendFormal.value,pendNonFormal:pendNonFormal.value,
   alamatDomisili:alamatDomisili.value,domKel:domKel.value,domKec:domKec.value,domKota:domKota.value,
   noHp:noHp.value,email:email.value,noKtp:noKtp.value,noNpwp:noNpwp.value,namaIbu:namaIbu.value,
   noRekening:noRekening.value,namaBank:namaBank.value,
   ktpAlamat:ktpAlamat.value,ktpKel:ktpKel.value,ktpKec:ktpKec.value,ktpKota:ktpKota.value,
   bpjsKet:bpjsKet.value,bpjsKes:bpjsKes.value,namaPasangan:namaPasangan.value,bpjsPasangan:bpjsPasangan.value,
   telpKerabat:telpKerabat.value,dataAnak:dataAnak.value,namaFaskes:namaFaskes.value,noKk:noKk.value
  },
  ...photos
 };
 await fetch(WEB_APP_URL,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify(data)});
 formStatus.textContent="Data tersimpan";
}
</script>
</body>
</html>
