<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Login Teknisi ‚Äì PT Putra Timur Jaya</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box}
body{
  margin:0;
  font-family:'Poppins',sans-serif;
  background:
    radial-gradient(circle at top left,#22c55e22,transparent 45%),
    radial-gradient(circle at bottom right,#2563eb22,transparent 50%),
    linear-gradient(135deg,#020617,#020617);
  color:#e5e7eb;
  min-height:100vh;
}
.container{max-width:1200px;margin:auto;padding:24px}
.grid-2{display:grid;grid-template-columns:1fr 1.3fr;gap:20px}
@media(max-width:900px){.grid-2{grid-template-columns:1fr}}

.glass{
  background:linear-gradient(180deg,rgba(2,6,23,.85),rgba(2,6,23,.75));
  backdrop-filter:blur(16px);
  border:1px solid rgba(148,163,184,.18);
  border-radius:22px;
  padding:22px;
  box-shadow:0 25px 60px rgba(0,0,0,.6);
}

label{font-size:12px;color:#93c5fd;margin-bottom:4px;display:block}
input,select,textarea{
  width:100%;
  padding:10px 12px;
  border-radius:12px;
  border:1px solid rgba(148,163,184,.25);
  background:rgba(2,6,23,.6);
  color:#f9fafb;
  font-size:13px;
}
textarea{min-height:70px}
input:focus,select:focus,textarea:focus{
  outline:none;border-color:#2563eb;
  box-shadow:0 0 0 2px rgba(37,99,235,.35)
}
.readonly{background:#0f172a;color:#94a3b8}

.section{margin-top:22px}
.section-title{
  font-size:13px;font-weight:600;letter-spacing:.1em;
  text-transform:uppercase;color:#93c5fd;
  margin-bottom:10px;border-bottom:1px solid rgba(148,163,184,.2)
}

.btn{
  border:none;padding:10px 16px;border-radius:999px;
  font-size:13px;font-weight:600;cursor:pointer
}
.btn-primary{background:linear-gradient(135deg,#2563eb,#1d4ed8);color:white}
.btn-secondary{background:transparent;border:1px solid #475569;color:#e5e7eb}
.btn-danger{background:#dc2626;color:white}
.btn-group{display:flex;gap:10px;margin-top:14px;flex-wrap:wrap}

.photo-box{
  background:#0f172a;border:1px dashed #475569;
  border-radius:14px;padding:12px;margin-bottom:10px
}
.photo-box img{
  max-width:120px;margin-top:8px;
  border-radius:10px;border:1px solid #334155
}

#previewWrapper{display:none;margin-top:40px}
.a4{
  width:210mm;min-height:297mm;background:white;color:black;
  padding:18mm;margin:auto;font-size:11px;
  box-shadow:0 15px 40px rgba(0,0,0,.35)
}
.a4 h1{text-align:center;font-size:15px}
.a4 h2{text-align:center;font-size:12px}
.table{width:100%;border-collapse:collapse;margin-top:10px}
.table td{border:1px solid #00000033;padding:4px 6px}
.page-number{text-align:right;font-size:10px;margin-top:10px}
</style>
</head>

<body>
<div class="container">

<h2>Login Teknisi</h2>
<p style="font-size:12px;color:#94a3b8">Gunakan akun absensi teknisi</p>

<div class="grid-2">

<!-- LOGIN -->
<div class="glass">
  <label>User ID</label>
  <input id="loginUser">

  <label>Password</label>
  <input id="loginPass" type="password">

  <button class="btn btn-primary" style="width:100%;margin-top:12px" onclick="login()">üîê Login</button>
  <p id="loginStatus"></p>
</div>

<!-- FORM -->
<div class="glass" id="formBox" style="display:none">

<div class="section">
<div class="section-title">Data Utama</div>

<label>User ID</label>
<input id="f_user" class="readonly" readonly>

<label>Nama Pegawai</label>
<input id="f_nama" class="readonly" readonly>

<label>Lokasi Kerja</label>
<input id="f_lokasi" class="readonly" readonly>

<label>Posisi Kerja</label>
<input id="f_posisi" class="readonly" readonly>

<label>Divisi</label>
<input id="f_divisi" class="readonly" readonly>
</div>

<div class="section">
<div class="section-title">Data Pribadi</div>

<label>Tempat / Tanggal Lahir</label>
<input id="ttl">

<label>Jenis Kelamin</label>
<select id="jk">
  <option value="Laki-laki">Laki-laki</option>
  <option value="Perempuan">Perempuan</option>
</select>
</div>

<div class="section">
<div class="section-title">Foto</div>

<div class="photo-box">
<label>Foto Teknisi</label>
<input type="file" id="fotoTeknisi">
<img id="p_fotoTeknisi">
</div>

<div class="photo-box"><label>Foto KTP</label><input type="file" id="fotoKtp"><img id="p_fotoKtp"></div>
<div class="photo-box"><label>Foto NPWP</label><input type="file" id="fotoNpwp"><img id="p_fotoNpwp"></div>
<div class="photo-box"><label>Foto BPJS Kesehatan</label><input type="file" id="fotoBpjsKes"><img id="p_fotoBpjsKes"></div>
<div class="photo-box"><label>Foto BPJS Ketenagakerjaan</label><input type="file" id="fotoBpjsKet"><img id="p_fotoBpjsKet"></div>
<div class="photo-box"><label>Foto KK</label><input type="file" id="fotoKk"><img id="p_fotoKk"></div>
</div>

<div class="btn-group">
<button class="btn btn-primary" onclick="simpan()">üíæ Simpan</button>
<button class="btn btn-secondary" onclick="preview()">üëÅ Preview</button>
<button class="btn btn-danger" onclick="logout()">üö™ Logout</button>
</div>

<p id="status"></p>

</div>
</div>

<!-- PREVIEW -->
<div id="previewWrapper">
<div class="a4">
<h1>BIODATA PEGAWAI</h1>
<h2>PT PUTRA TIMUR JAYA</h2>

<table class="table">
<tr><td>Nama</td><td id="pv_nama"></td></tr>
<tr><td>TTL</td><td id="pv_ttl"></td></tr>
<tr><td>Jenis Kelamin</td><td id="pv_jk"></td></tr>
</table>

<div class="page-number">2 / 4</div>
</div>
</div>

</div>

<script>
/* ================= CONFIG ================= */
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbzfYMYq83BYCNxITAK-CbGQ0uA5diRWuFw1-kyd7zzqmcFR_3hwWnHtNNDLTF4mUHc/exec";

/* USER */
const USERS=[{
  u:"PTJ_Arip007",
  p:"alvaro007",
  nama:"ARIP RAHMATULLOH",
  lokasi:"CMI",
  posisi:"BASIC_TEKNISI",
  divisi:"PIC"
}];

let currentUser=null;
let foto={};

/* LOGIN FIX */
function login(){
  const u=document.getElementById("loginUser").value.trim();
  const p=document.getElementById("loginPass").value.trim();

  const user=USERS.find(x=>x.u===u && x.p===p);
  if(!user){
    loginStatus.textContent="‚ùå Login gagal";
    loginStatus.style.color="#ef4444";
    return;
  }

  currentUser=user;
  loginStatus.textContent="‚úÖ Login berhasil";
  loginStatus.style.color="#22c55e";

  formBox.style.display="block";

  f_user.value=user.u;
  f_nama.value=user.nama;
  f_lokasi.value=user.lokasi;
  f_posisi.value=user.posisi;
  f_divisi.value=user.divisi;
}

function logout(){
  currentUser=null;
  formBox.style.display="none";
}

/* FOTO */
function bindFile(id){
  document.getElementById(id).addEventListener("change",e=>{
    const file=e.target.files[0];
    if(!file) return;
    const r=new FileReader();
    r.onload=()=>{
      foto[id]=r.result;
      document.getElementById("p_"+id).src=r.result;
    };
    r.readAsDataURL(file);
  });
}
["fotoTeknisi","fotoKtp","fotoNpwp","fotoBpjsKes","fotoBpjsKet","fotoKk"].forEach(bindFile);

/* SIMPAN FIX */
function simpan(){
  if(!currentUser){
    alert("Login dulu");
    return;
  }

  status.textContent="Menyimpan...";
  fetch(WEB_APP_URL,{
    method:"POST",
    headers:{ "Content-Type":"text/plain;charset=utf-8" },
    body:JSON.stringify({
      mode:"saveBiodata",
      user:currentUser,
      biodata:{
        ttl:ttl.value,
        jenisKelamin:jk.value
      },
      foto:foto
    })
  })
  .then(r=>r.text())
  .then(t=>{
    status.textContent="‚úÖ BERHASIL DISIMPAN";
    status.style.color="#22c55e";
    console.log("RESPON:",t);
  })
  .catch(err=>{
    status.textContent="‚ùå Gagal menyimpan";
    console.error(err);
  });
}

/* PREVIEW */
function preview(){
  pv_nama.textContent=f_nama.value;
  pv_ttl.textContent=ttl.value;
  pv_jk.textContent=jk.value;
  previewWrapper.style.display="block";
}
</script>
</body>
</html>
